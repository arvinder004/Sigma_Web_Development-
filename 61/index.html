<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async/Await & Fetch API in Javascript</title>
</head>

<body>
    <script>

        // async function getData() {  //async function works in background
        //     //simulate getting data from server
        //     return new Promise((resolve, reject) => {
        //         setTimeout(() => {
        //             resolve(455)
        //         }, 3000);
        //     })
        // }

        async function getData(){
            let x = await fetch('https://jsonplaceholder.typicode.com/todos/1')
            let data = await x.json()
            console.log(data)
        }

        async function main(){
            console.log("Loading modules")
            console.log("Do something else")
            console.log("load data")

            let data = await getData() //engine will wait for this function to execute

            //await keyword can only be used inside an async function
            //await keyword makes the function pause the execution and wait for a resolved promise before it continues

            console.log(data)
            console.log("process data")
            console.log("task 2")
        }

        main()


        //POST method implementation

        async function postData(url = "", data = {}){
            const response = await fetch(url, {
                method : "POST",
                headers: {
                    "Content-Type" : "application/json",
                },
                body: JSON.stringify(data),
            });
            return response.json();
        }

        postData("https://example.com/answer", {answer : 42}).then((data) => {
            console.log(data);
        });


        // data.then((v) =>{

        //     console.log(data)
        //     console.log("process data")
        //     console.log("task 2")
        // })                                     
        </script>      
</body>

</html>